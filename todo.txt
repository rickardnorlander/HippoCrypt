Todo:
Run slow things off EDT
Better initial setup
Support for attachments
Support for text/html
Encrypt subject
Encrypt attachments
Caching!

Keep in mind:

Disable all html for risky components